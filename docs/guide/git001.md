# Git 开发流程入门：从克隆到提交的正确步骤

## 一、原步骤中的问题分析

您提供的 Git 使用步骤存在以下关键错误：

| 步骤 | 错误内容                   | 正确做法                                           |
| ---- | -------------------------- | -------------------------------------------------- |
| 3    | 修改代码后切换到 main 分支 | **应在个人分支完成所有修改和提交**                 |
| 4-6  | 直接提交到 main 分支       | **应先提交到个人分支，再通过合并或 PR 更新主分支** |

**错误原因**：直接在 main 分支提交会导致代码混乱，尤其在多人协作时会产生大量冲突和难以追踪的修改。

## 二、Git 开发的基本概念

### 1. 什么是分支？

- **分支**就像代码的平行宇宙，允许你在不影响主代码的情况下进行修改
- **main/master 分支**：主分支，应保持随时可发布的稳定状态
- **个人分支**：用于开发新功能或修复 bug 的临时分支

### 2. 为什么需要分支开发？

- 隔离开发工作，避免相互干扰
- 支持多人并行开发
- 方便代码审查和版本控制

## 三、正确的 Git 开发流程

### 流程图

```
main分支 ────────●─────────●─────────● (稳定版本)
                 ↑         ↑         ↑
个人分支         ●───●───●──┘         │ (合并后删除)
                           │
另一个分支                 ●───●─────┘ (合并后删除)
```

### 详细步骤

#### 1. 准备工作：安装和配置 Git

**安装 Git**

- Windows：下载并安装 [Git for Windows](https://git-scm.com/download/win)
- Mac：使用 Homebrew `brew install git`
- Linux：使用包管理器 `sudo apt install git` (Ubuntu/Debian) 或 `sudo yum install git` (CentOS)

**初始配置**

```bash
# 设置用户名和邮箱(与GitHub账号一致)
git config --global user.name "你的名字"
git config --global user.email "你的邮箱"

# 检查配置
git config --list
```

#### 2. 克隆远程仓库

```bash
# 从GitHub拉取项目(替换为实际仓库URL)
git clone https://github.com/用户名/仓库名.git

# 进入项目目录
cd 仓库名
```

#### 3. 创建并切换到个人分支

```bash
# 创建并切换到名为"kaikyou"的分支
git checkout -b kaikyou
```

> **说明**：`-b` 参数表示创建新分支并立即切换到该分支

#### 4. 进行代码修改

- 在 IDE 中打开项目并进行修改
- **重要**：所有开发工作都应在个人分支进行

#### 5. 查看修改内容

```bash
# 查看修改状态
git status

# 查看具体修改内容
git diff
```

#### 6. 暂存并提交修改

**暂存文件**

```bash
# 添加所有修改文件
git add .

# 或添加指定文件(推荐，更精确)
git add 文件名1 文件名2
```

**提交修改**

```bash
git commit -m "清晰描述修改内容"
```

> **提交信息书写规范**：
>
> - 简短明了(不超过 50 字符)
> - 使用动词开头："添加"、"修复"、"优化"等
> - 例：`git commit -m "添加用户登录功能"`

#### 7. 推送个人分支到远程

```bash
git push origin kaikyou
```

> **说明**：`origin` 是远程仓库的默认别名，`kaikyou` 是你的分支名

#### 8. 合并到主分支(两种方式)

**方式一：命令行合并(适用于个人项目)**

```bash
# 切换到主分支
git checkout main

# 拉取最新的主分支代码
git pull origin main

# 合并个人分支到主分支
git merge kaikyou

# 推送合并后的主分支到远程
git push origin main
```

**方式二：通过 GitHub Pull Request(推荐用于团队协作)**

1. 访问 GitHub 仓库页面
2. 点击"Pull requests" → "New pull request"
3. 选择你的分支(kaikyou)与主分支(main)进行比较
4. 添加描述并点击"Create pull request"
5. 等待审核通过后，点击"Merge pull request"

#### 9. 删除已完成的分支(可选)

```bash
# 切换回主分支
git checkout main

# 删除本地个人分支
git branch -d kaikyou

# 删除远程个人分支(如果不再需要)
git push origin --delete kaikyou
```

## 四、常用 Git 命令速查表

| 命令                       | 作用             | 示例                                      |
| -------------------------- | ---------------- | ----------------------------------------- |
| `git clone`                | 克隆远程仓库     | `git clone <仓库URL>`                     |
| `git branch`               | 查看所有分支     | `git branch`                              |
| `git checkout -b <分支名>` | 创建并切换分支   | `git checkout -b feature-x`               |
| `git status`               | 查看工作区状态   | `git status`                              |
| `git add <文件>`           | 暂存文件         | `git add index.html` 或 `git add .`(全部) |
| `git commit -m "<信息>"`   | 提交修改         | `git commit -m "修复登录bug"`             |
| `git push origin <分支名>` | 推送分支到远程   | `git push origin kaikyou`                 |
| `git pull origin <分支名>` | 拉取远程分支更新 | `git pull origin main`                    |
| `git merge <分支名>`       | 合并分支         | `git merge kaikyou`                       |
| `git log`                  | 查看提交历史     | `git log --oneline`(简洁模式)             |

## 五、常见问题及解决方法

### 1. 提交后发现错误，如何撤销？

```bash
# 撤销最近一次提交，但保留修改内容
git reset --soft HEAD~1

# 修改后重新提交
git commit -m "修正：正确的提交信息"
```

### 2. 如何放弃本地所有修改，回到最新提交状态？

```bash
# 警告：这会删除所有未提交的修改，请谨慎使用
git reset --hard HEAD
```

### 3. 拉取代码时遇到冲突怎么办？

```bash
# 1. 拉取最新代码
git pull origin main

# 2. 如果出现冲突，Git会提示哪些文件有冲突
# 3. 打开这些文件，寻找冲突标记并解决
#    <<<<<<< HEAD
#    当前分支的代码
#    =======
#    待合并分支的代码
#    >>>>>>> branch-name

# 4. 解决后标记为已解决并提交
git add .
git commit -m "解决合并冲突"
```

### 4. 忘记创建分支，直接在 main 分支修改了怎么办？

```bash
# 1. 先提交修改(如果尚未提交)
git add .
git commit -m "临时提交"

# 2. 切换到main分支
git checkout main

# 3. 创建并切换到新分支
git checkout -b kaikyou

# 4. 删除main分支上的临时提交
git checkout main
git reset --hard HEAD~1
```

## 六、最佳实践

1. **频繁提交**：小步修改，频繁提交，每次提交只做一件事
2. **有意义的提交信息**：清晰描述修改内容，便于日后追踪
3. **定期同步主分支**：在个人分支开发时，定期从 main 分支同步最新代码
   ```bash
   # 在个人分支执行
   git pull origin main
   ```
4. **使用.gitignore 文件**：忽略不需要提交的文件(如 IDE 配置、日志、依赖包等)
5. **保护主分支**：在 GitHub 上设置 main 分支保护规则，要求 PR 和代码审查

## 七、总结

正确的 Git 开发流程应该是：

1. 从主分支创建个人分支
2. 在个人分支上开发
3. 提交到个人分支
4. 推送个人分支到远程
5. 通过 PR 或合并到主分支

遵循这些步骤可以使代码管理更加有序，减少冲突，提高团队协作效率。Git 学习曲线虽然陡峭，但掌握后会极大提升开发效率！
